(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{68:function(e,t,a){e.exports=a(97)},90:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(7),i=a.n(r),o=a(30),u=a(31),l=a(41),c=a(39),d=a(28),h=a.n(d),p=(a(90),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).audioPlayer=n.a.createRef(),s}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){null!=this.audioPlayer.current&&this.props.play&&(this.audioPlayer.current.pause(),this.audioPlayer.current.load(),this.audioPlayer.current.play())}},{key:"render",value:function(){var e=n.a.createElement("audio",{controls:!0,ref:this.audioPlayer},n.a.createElement("source",{src:"data:audio/mpeg;base64,"+this.props.audio,type:"audio/mpeg"}),"Your browser does not support the audio element.");return n.a.createElement("div",{id:"result"},null==this.props.audio?"":e)}}]),a}(n.a.Component)),g=a(134),m=a(135),b=a(138),f=a(136),y=a(141),v=a(139),k=a(142),E=a(59),w=a.n(E);function S(e){return n.a.createElement(v.a,Object.assign({elevation:6,variant:"filled"},e))}var C=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).sendTask=function(){h.a.post("/api/task",{text:s.state.text}).then((function(e){if(!e.data.request_successful)throw new Error(e.data.message);setTimeout(s.checkProgress,250,e.data.id)})).catch((function(e){s.setState({audio:null,play:!1,buttonDisabled:!1,progress:null,requestStatus:{success:!1,errorMessage:e.toString()},snackbarOpen:!0})}))},s.checkProgress=function(e){h.a.get("/api/progress?id="+e).then((function(t){if(!t.data.request_successful)throw new Error(t.data.message);var a=t.data.result;s.setState({progress:a.progress}),a.finished?s.retrieveResult(e):setTimeout(s.checkProgress,500,e)})).catch((function(e){s.setState({audio:null,play:!1,buttonDisabled:!1,progress:null,requestStatus:{success:!1,errorMessage:e.toString()},snackbarOpen:!0})}))},s.retrieveResult=function(e){h.a.get("/api/result?id="+e).then((function(t){if(t.data.request_successful){var a=t.data.result;return s.setState({audio:a.audio,play:!0,buttonDisabled:!1,progress:null,requestStatus:{success:a.synthesis_successful,errorMessage:a.message},snackbarOpen:!0}),s.textHasChanged=!1,h.a.delete("/api/result?id="+e)}throw new Error(t.data.message)})).then((function(e){if(!e.data.request_successful)throw new Error(e.data.message)})).catch((function(e){s.setState({play:!1,buttonDisabled:!1,progress:null,requestStatus:{success:!1,errorMessage:e.toString()},snackbarOpen:!0})}))},s.handleSubmit=function(e){e.preventDefault(),s.textHasChanged?(s.setState({buttonDisabled:!0,progress:0}),s.sendTask()):s.setState((function(e){return{play:!0,snackbarOpen:!0}}))},s.handleChange=function(e){s.setState({text:e.target.value,play:!1,snackbarOpen:!1}),s.textHasChanged=!0},s.handleClose=function(e){s.setState({snackbarOpen:!1,play:!1})},s.state={text:"",audio:null,buttonDisabled:!1,play:!1,progress:null,requestStatus:{success:!0,errorMessage:null},snackbarOpen:!1,innerHeight:window.innerHeight,innerWidth:window.innerWidth,red:0,green:0,blue:0},s.textHasChanged=!1,s.d_red=Math.random(),s.d_green=Math.random(),s.d_blue=Math.random(),setInterval((function(){s.setState({red:s.state.red+s.d_red,green:s.state.green+s.d_green,blue:s.state.blue+s.d_blue,play:!1},(function(){(s.state.red<=0||s.state.red>=50)&&(s.d_red*=-1),(s.state.green<=0||s.state.green>=50)&&(s.d_green*=-1),(s.state.blue<=0||s.state.blue>=50)&&(s.d_blue*=-1)}))}),25),s}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){e.setState({innerHeight:window.innerHeight,innerWidth:window.innerWidth,play:!1})}))}},{key:"render",value:function(){var e="";if(this.state.requestStatus.success)if(this.state.requestStatus.errorMessage&&this.state.requestStatus.errorMessage.length>0){var t=this.state.requestStatus.errorMessage,a=t.length,s=(new Date).getTime();e=n.a.createElement(S,{onClose:this.handleClose,severity:"warning"},t.map((function(e,t){return n.a.createElement("span",{key:s+"-"+t},e,t!==a-1?n.a.createElement("br",null):"")})))}else e=n.a.createElement(S,{onClose:this.handleClose,severity:"success"},"\u6b63\u5728\u64ad\u653e");else e=n.a.createElement(S,{onClose:this.handleClose,severity:"error"},this.state.requestStatus.errorMessage);var r=n.a.createElement(y.a,{open:this.state.snackbarOpen,autoHideDuration:6e3,onClose:this.handleClose},e),i="rgb(".concat(this.state.red,",").concat(this.state.green,",").concat(this.state.blue,")");return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{id:"filter",style:{backgroundColor:i}}),n.a.createElement("div",{id:"content"},n.a.createElement(g.a,{variant:this.state.innerWidth<650?"h4":"h3",color:"textPrimary",style:{marginBottom:24}},"\u4e60\u8fd1\u5e73\u8bb2\u8bdd\u6a21\u62df\u5668"),n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement(b.a,{id:"text",multiline:!0,placeholder:"\u8bf7\u8f93\u5165\u6587\u672c",onChange:this.handleChange,value:this.state.text,rowsMax:Math.round(this.state.innerHeight/(this.state.innerHeight>700?40:70))}),n.a.createElement("br",null),n.a.createElement(m.a,{size:"large",id:"button",disabled:this.state.buttonDisabled,type:"submit",style:{margin:24},variant:"outlined"},"\u7389 \u97f3 \u653e \u9001")),null!=this.state.progress?n.a.createElement(f.a,{variant:1!==this.state.progress&&0!==this.state.progress?"determinate":"query",value:100*this.state.progress,style:{marginBottom:24}}):"",n.a.createElement(p,{audio:this.state.audio,play:this.state.play})),r,n.a.createElement("a",{href:"https://github.com/dnmkrgi/xi-speech-synthesizer"},n.a.createElement(k.a,{id:"about"},n.a.createElement(w.a,null))))}}]),a}(n.a.Component);a(96),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var O=a(60),x=a(137),q=Object(O.a)({palette:{type:"dark",primary:{main:"#fafafa"}}});i.a.render(n.a.createElement(x.a,{theme:q},n.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[68,1,2]]]);
//# sourceMappingURL=main.8fee723a.chunk.js.map